{"ast":null,"code":"var _jsxFileName = \"/Users/andres/Documents/Henry/bootcamp/PI-Countries-main/client/src/components/Home.jsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getCountries, getActivitiesList, countriesTools } from \"../actions\";\nimport { Link } from \"react-router-dom\";\nimport CountryCard from \"./CountryCard.jsx\";\nimport Paging from \"./Paging\";\nimport style from \"./Home.module.css\";\nimport \"./Global.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Home() {\n  _s();\n\n  const dispatch = useDispatch(); // LOCAL STATES\n\n  const [filter, setFilter] = useState({\n    region: \"\",\n    activity: \"\"\n  });\n  const [order, setOrder] = useState('');\n  const [searchText, setSearchText] = useState('');\n  const [allCountries, setAllCountries] = useState([]);\n  const [regionList, setRegionList] = useState([]); // GLOBAL STATE\n\n  const countries = useSelector(state => state.countries, () => {});\n  const activitiesList = useSelector(state => state.activitiesList); // DOM REFERENCES\n\n  const inputSearch = useRef(); // PAGING\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [countriesXPage, setCountriesXPage] = useState(9);\n  const [totalPages, setTotalPages] = useState(0); // Seria interesante hacer orderList dinámica\n  // const orderList = ['none', 'asc', 'des', 'popUp', 'popDown'];\n  /////// INITIALIZATION\n\n  useEffect(() => {\n    dispatch(getCountries());\n    dispatch(getActivitiesList());\n  }, []); // Cuando countries esta cargado:\n\n  useEffect(() => {\n    if (allCountries.length === 0) {\n      // Comprobación, para que esto suceda una sola vez.\n      setAllCountries([...countries]);\n      setRegionList(countries.map(obj => obj.region) // convierte el obj en arr\n      .filter((item, index, arr) => arr.indexOf(item) === index)); // filtra repeticiones);\n\n      pages(1);\n    }\n  }, [countries]); // Re-inicialización forzada con botón\n\n  function handleReloadDB(e) {\n    e.preventDefault();\n    setAllCountries([]);\n    dispatch(getCountries());\n    dispatch(getActivitiesList());\n  } ///// PAGING\n\n\n  const lastCountry = currentPage * countriesXPage;\n  const firstCountry = lastCountry - countriesXPage;\n  const pageCountries = countries.slice(firstCountry, lastCountry);\n\n  const pages = page => {\n    // if (page === 1) setCountriesXPage(9);\n    // else setCountriesXPage(10);\n    setCurrentPage(page);\n  };\n\n  useEffect(() => {\n    if (countries) {\n      const calcTotalPages = Math.ceil(countries.length / countriesXPage);\n      setTotalPages(calcTotalPages);\n      if (currentPage > calcTotalPages) setCurrentPage(1);\n    }\n  }, [countries, countriesXPage]); //////////////////////////// COUNTRIES TOOLS : FILTER, SEARCH && ORDER\n\n  useEffect(() => {\n    dispatch(countriesTools(filter, searchText, order, allCountries));\n    pages(currentPage);\n  }, [order, filter, searchText]); // FILTER\n\n  function handleFilter(e) {\n    setFilter({ ...filter,\n      [e.target.name]: e.target.value\n    }); // { region:'Asia', activity:'Cagar' }\n  }\n\n  const regionFilter = useRef();\n  const activityFilter = useRef();\n\n  function handleClearFilters() {\n    setFilter({});\n    regionFilter.current.value = '';\n    activityFilter.current.value = '';\n  } // SEARCH\n\n\n  function handleResetButton(e) {\n    e.preventDefault();\n    setSearchText('');\n    inputSearch.current.value = '';\n  }\n\n  function handleSearchText(e) {\n    setSearchText(e.target.value);\n  } // ORDER\n\n\n  function handleOrder(e) {\n    setOrder(e.target.id);\n  } // La barra de botones se podria modularizar\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: style.container,\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      children: \"Results/page:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"range\",\n      min: \"8\",\n      max: \"36\",\n      value: countriesXPage,\n      onChange: e => setCountriesXPage(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      children: countriesXPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Link, {\n      to: \"/activities\",\n      children: \"Crear actividad\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"button\",\n      value: \"Reload\",\n      onChange: handleReloadDB\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Home de Countries\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: style.order,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Sort:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        id: \"asc\",\n        name: \"order\",\n        value: \"ASC\",\n        onClick: handleOrder\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        id: \"des\",\n        name: \"order\",\n        value: \"DES\",\n        onClick: handleOrder\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        id: \"popUp\",\n        name: \"order\",\n        value: \"PopUp\",\n        onClick: handleOrder\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        id: \"popDown\",\n        name: \"order\",\n        value: \"PopDown\",\n        onClick: handleOrder\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: style.search,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Search:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"searchText\",\n        name: \"searchText\",\n        onChange: handleSearchText,\n        ref: inputSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        onClick: handleResetButton,\n        value: \"Reset\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: style.filter,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Filter:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        name: \"region\",\n        id: \"\",\n        onChange: handleFilter,\n        ref: regionFilter,\n        defaultValue: \"Filter by region\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          selected: true,\n          disabled: true,\n          hidden: true,\n          children: \"Filter by region\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"All regions\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this), regionList && regionList.map(reg => {\n          return /*#__PURE__*/_jsxDEV(\"option\", {\n            value: reg,\n            children: reg\n          }, reg, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 23\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        name: \"activity\",\n        id: \"\",\n        onChange: handleFilter,\n        ref: activityFilter,\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          selected: true,\n          disabled: true,\n          hidden: true,\n          children: \"Filter by activity\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"All activities\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this), activitiesList && activitiesList.map(act => {\n          return /*#__PURE__*/_jsxDEV(\"option\", {\n            value: act,\n            children: act\n          }, act, false, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 23\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        onClick: handleClearFilters,\n        value: \"Clear filters\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Paging, {\n      totalPages: totalPages,\n      currentPage: currentPage,\n      pages: pages\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: style.countries,\n      children: countries.length ? pageCountries.map(country => {\n        return /*#__PURE__*/_jsxDEV(CountryCard, {\n          name: country.name,\n          region: country.region,\n          flag: country.flag,\n          flag_icon: country.flag_icon,\n          id: country.id\n        }, country.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 15\n        }, this);\n      }) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: style.loader\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 14\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Home, \"aRQWpyWkUf+mpugrFSjEbSs35Cw=\", false, function () {\n  return [useDispatch, useSelector, useSelector];\n});\n\n_c = Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["/Users/andres/Documents/Henry/bootcamp/PI-Countries-main/client/src/components/Home.jsx"],"names":["React","useState","useEffect","useRef","useDispatch","useSelector","getCountries","getActivitiesList","countriesTools","Link","CountryCard","Paging","style","Home","dispatch","filter","setFilter","region","activity","order","setOrder","searchText","setSearchText","allCountries","setAllCountries","regionList","setRegionList","countries","state","activitiesList","inputSearch","currentPage","setCurrentPage","countriesXPage","setCountriesXPage","totalPages","setTotalPages","length","map","obj","item","index","arr","indexOf","pages","handleReloadDB","e","preventDefault","lastCountry","firstCountry","pageCountries","slice","page","calcTotalPages","Math","ceil","handleFilter","target","name","value","regionFilter","activityFilter","handleClearFilters","current","handleResetButton","handleSearchText","handleOrder","id","container","search","reg","act","country","flag","flag_icon","loader"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,SAASC,QAAT,EAAmBC,SAAnB,EAA8BC,MAA9B,QAA4C,OAA5C;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,YAAT,EAAuBC,iBAAvB,EAA0CC,cAA1C,QAAgE,YAAhE;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,OAAOC,WAAP,MAAwB,mBAAxB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,mBAAlB;AACA,OAAO,cAAP;;AAEA,eAAe,SAASC,IAAT,GAAgB;AAAA;;AAC7B,QAAMC,QAAQ,GAAGV,WAAW,EAA5B,CAD6B,CAG7B;;AACA,QAAM,CAACW,MAAD,EAASC,SAAT,IAAsBf,QAAQ,CAAC;AAAEgB,IAAAA,MAAM,EAAE,EAAV;AAAcC,IAAAA,QAAQ,EAAE;AAAxB,GAAD,CAApC;AACA,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBnB,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAM,CAACoB,UAAD,EAAaC,aAAb,IAA8BrB,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM,CAACsB,YAAD,EAAeC,eAAf,IAAkCvB,QAAQ,CAAC,EAAD,CAAhD;AACA,QAAM,CAACwB,UAAD,EAAaC,aAAb,IAA8BzB,QAAQ,CAAC,EAAD,CAA5C,CAR6B,CAS7B;;AACA,QAAM0B,SAAS,GAAGtB,WAAW,CAAEuB,KAAD,IAAWA,KAAK,CAACD,SAAlB,EAA6B,MAAM,CAAG,CAAtC,CAA7B;AACA,QAAME,cAAc,GAAGxB,WAAW,CAAEuB,KAAD,IAAWA,KAAK,CAACC,cAAlB,CAAlC,CAX6B,CAY7B;;AACA,QAAMC,WAAW,GAAG3B,MAAM,EAA1B,CAb6B,CAc7B;;AACA,QAAM,CAAC4B,WAAD,EAAcC,cAAd,IAAgC/B,QAAQ,CAAC,CAAD,CAA9C;AACA,QAAM,CAACgC,cAAD,EAAiBC,iBAAjB,IAAsCjC,QAAQ,CAAC,CAAD,CAApD;AACA,QAAM,CAACkC,UAAD,EAAaC,aAAb,IAA8BnC,QAAQ,CAAC,CAAD,CAA5C,CAjB6B,CAmB7B;AACA;AAEA;;AACAC,EAAAA,SAAS,CAAC,MAAM;AACdY,IAAAA,QAAQ,CAACR,YAAY,EAAb,CAAR;AACAQ,IAAAA,QAAQ,CAACP,iBAAiB,EAAlB,CAAR;AACD,GAHQ,EAGN,EAHM,CAAT,CAvB6B,CA2B7B;;AACAL,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIqB,YAAY,CAACc,MAAb,KAAwB,CAA5B,EAA+B;AAAG;AAChCb,MAAAA,eAAe,CAAC,CAAC,GAAGG,SAAJ,CAAD,CAAf;AACAD,MAAAA,aAAa,CAACC,SAAS,CACpBW,GADW,CACNC,GAAD,IAASA,GAAG,CAACtB,MADN,EACc;AADd,OAEXF,MAFW,CAEJ,CAACyB,IAAD,EAAOC,KAAP,EAAcC,GAAd,KAAsBA,GAAG,CAACC,OAAJ,CAAYH,IAAZ,MAAsBC,KAFxC,CAAD,CAAb,CAF6B,CAIkC;;AAC/DG,MAAAA,KAAK,CAAC,CAAD,CAAL;AACD;AACF,GARQ,EAQN,CAACjB,SAAD,CARM,CAAT,CA5B6B,CAsC7B;;AACA,WAASkB,cAAT,CAAwBC,CAAxB,EAA2B;AACzBA,IAAAA,CAAC,CAACC,cAAF;AACAvB,IAAAA,eAAe,CAAC,EAAD,CAAf;AACAV,IAAAA,QAAQ,CAACR,YAAY,EAAb,CAAR;AACAQ,IAAAA,QAAQ,CAACP,iBAAiB,EAAlB,CAAR;AACD,GA5C4B,CA8C7B;;;AAEA,QAAMyC,WAAW,GAAGjB,WAAW,GAAGE,cAAlC;AACA,QAAMgB,YAAY,GAAGD,WAAW,GAAGf,cAAnC;AACA,QAAMiB,aAAa,GAAGvB,SAAS,CAACwB,KAAV,CAAgBF,YAAhB,EAA8BD,WAA9B,CAAtB;;AAEA,QAAMJ,KAAK,GAAIQ,IAAD,IAAU;AACtB;AACA;AACApB,IAAAA,cAAc,CAACoB,IAAD,CAAd;AACD,GAJD;;AAMAlD,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIyB,SAAJ,EAAe;AACb,YAAM0B,cAAc,GAAGC,IAAI,CAACC,IAAL,CAAU5B,SAAS,CAACU,MAAV,GAAmBJ,cAA7B,CAAvB;AACAG,MAAAA,aAAa,CAACiB,cAAD,CAAb;AACA,UAAItB,WAAW,GAAGsB,cAAlB,EAAkCrB,cAAc,CAAC,CAAD,CAAd;AACnC;AACF,GANQ,EAMN,CAACL,SAAD,EAAYM,cAAZ,CANM,CAAT,CA1D6B,CAiE7B;;AAEA/B,EAAAA,SAAS,CAAC,MAAM;AACdY,IAAAA,QAAQ,CAACN,cAAc,CAACO,MAAD,EAASM,UAAT,EAAqBF,KAArB,EAA4BI,YAA5B,CAAf,CAAR;AACAqB,IAAAA,KAAK,CAACb,WAAD,CAAL;AACD,GAHQ,EAGN,CAACZ,KAAD,EAAQJ,MAAR,EAAgBM,UAAhB,CAHM,CAAT,CAnE6B,CAwE7B;;AACA,WAASmC,YAAT,CAAsBV,CAAtB,EAAyB;AACvB9B,IAAAA,SAAS,CAAC,EAAE,GAAGD,MAAL;AAAa,OAAC+B,CAAC,CAACW,MAAF,CAASC,IAAV,GAAiBZ,CAAC,CAACW,MAAF,CAASE;AAAvC,KAAD,CAAT,CADuB,CACoC;AAC5D;;AACD,QAAMC,YAAY,GAAGzD,MAAM,EAA3B;AACA,QAAM0D,cAAc,GAAG1D,MAAM,EAA7B;;AACA,WAAS2D,kBAAT,GAA8B;AAC5B9C,IAAAA,SAAS,CAAC,EAAD,CAAT;AACA4C,IAAAA,YAAY,CAACG,OAAb,CAAqBJ,KAArB,GAA6B,EAA7B;AACAE,IAAAA,cAAc,CAACE,OAAf,CAAuBJ,KAAvB,GAA+B,EAA/B;AACD,GAlF4B,CAmF7B;;;AACA,WAASK,iBAAT,CAA2BlB,CAA3B,EAA8B;AAC5BA,IAAAA,CAAC,CAACC,cAAF;AACAzB,IAAAA,aAAa,CAAC,EAAD,CAAb;AACAQ,IAAAA,WAAW,CAACiC,OAAZ,CAAoBJ,KAApB,GAA4B,EAA5B;AACD;;AACD,WAASM,gBAAT,CAA0BnB,CAA1B,EAA6B;AAC3BxB,IAAAA,aAAa,CAACwB,CAAC,CAACW,MAAF,CAASE,KAAV,CAAb;AACD,GA3F4B,CA4F7B;;;AACA,WAASO,WAAT,CAAqBpB,CAArB,EAAwB;AACtB1B,IAAAA,QAAQ,CAAC0B,CAAC,CAACW,MAAF,CAASU,EAAV,CAAR;AACD,GA/F4B,CAiG7B;;;AACA,sBACE;AAAK,IAAA,EAAE,EAAEvD,KAAK,CAACwD,SAAf;AAAA,4BAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAHF,eAIE;AAAO,MAAA,IAAI,EAAC,OAAZ;AAAoB,MAAA,GAAG,EAAC,GAAxB;AAA4B,MAAA,GAAG,EAAC,IAAhC;AAAqC,MAAA,KAAK,EAAEnC,cAA5C;AAA4D,MAAA,QAAQ,EAAGa,CAAD,IAAOZ,iBAAiB,CAACY,CAAC,CAACW,MAAF,CAASE,KAAV;AAA9F;AAAA;AAAA;AAAA;AAAA,YAJF,eAKE;AAAA,gBAAO1B;AAAP;AAAA;AAAA;AAAA;AAAA,YALF,eAOE,QAAC,IAAD;AAAM,MAAA,EAAE,EAAC,aAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAPF,eASE;AAAO,MAAA,IAAI,EAAC,QAAZ;AAAqB,MAAA,KAAK,EAAC,QAA3B;AAAoC,MAAA,QAAQ,EAAEY;AAA9C;AAAA;AAAA;AAAA;AAAA,YATF,eAWE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAXF,eAcE;AAAK,MAAA,EAAE,EAAEjC,KAAK,CAACO,KAAf;AAAA,8BACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAGE;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAqB,QAAA,EAAE,EAAC,KAAxB;AAA8B,QAAA,IAAI,EAAC,OAAnC;AAA2C,QAAA,KAAK,EAAC,KAAjD;AAAuD,QAAA,OAAO,EAAE+C;AAAhE;AAAA;AAAA;AAAA;AAAA,cAHF,eAIE;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAqB,QAAA,EAAE,EAAC,KAAxB;AAA8B,QAAA,IAAI,EAAC,OAAnC;AAA2C,QAAA,KAAK,EAAC,KAAjD;AAAuD,QAAA,OAAO,EAAEA;AAAhE;AAAA;AAAA;AAAA;AAAA,cAJF,eAKE;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAqB,QAAA,EAAE,EAAC,OAAxB;AAAgC,QAAA,IAAI,EAAC,OAArC;AAA6C,QAAA,KAAK,EAAC,OAAnD;AAA2D,QAAA,OAAO,EAAEA;AAApE;AAAA;AAAA;AAAA;AAAA,cALF,eAME;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAqB,QAAA,EAAE,EAAC,SAAxB;AAAkC,QAAA,IAAI,EAAC,OAAvC;AAA+C,QAAA,KAAK,EAAC,SAArD;AAA+D,QAAA,OAAO,EAAEA;AAAxE;AAAA;AAAA;AAAA;AAAA,cANF;AAAA;AAAA;AAAA;AAAA;AAAA,YAdF,eAwBE;AAAK,MAAA,EAAE,EAAEtD,KAAK,CAACyD,MAAf;AAAA,8BACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,EAAE,EAAC,YAAtB;AAAmC,QAAA,IAAI,EAAC,YAAxC;AAAqD,QAAA,QAAQ,EAAEJ,gBAA/D;AAAiF,QAAA,GAAG,EAAEnC;AAAtF;AAAA;AAAA;AAAA;AAAA,cAFF,eAGE;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAqB,QAAA,OAAO,EAAEkC,iBAA9B;AAAiD,QAAA,KAAK,EAAC;AAAvD;AAAA;AAAA;AAAA;AAAA,cAHF;AAAA;AAAA;AAAA;AAAA;AAAA,YAxBF,eA8BE;AAAK,MAAA,EAAE,EAAEpD,KAAK,CAACG,MAAf;AAAA,8BACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAIE;AAAQ,QAAA,IAAI,EAAC,QAAb;AAAsB,QAAA,EAAE,EAAC,EAAzB;AAA4B,QAAA,QAAQ,EAAEyC,YAAtC;AAAoD,QAAA,GAAG,EAAEI,YAAzD;AAAuE,QAAA,YAAY,EAAC,kBAApF;AAAA,gCACE;AAAQ,UAAA,KAAK,EAAC,EAAd;AAAiB,UAAA,QAAQ,MAAzB;AAA0B,UAAA,QAAQ,MAAlC;AAAmC,UAAA,MAAM,MAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAQ,UAAA,KAAK,EAAC,EAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF,EAIInC,UAAU,IAAIA,UAAU,CAACa,GAAX,CAAgBgC,GAAD,IAAS;AACpC,8BAAQ;AAAQ,YAAA,KAAK,EAAEA,GAAf;AAAA,sBAAgCA;AAAhC,aAAyBA,GAAzB;AAAA;AAAA;AAAA;AAAA,kBAAR;AACD,SAFa,CAJlB;AAAA;AAAA;AAAA;AAAA;AAAA,cAJF,eAcE;AAAQ,QAAA,IAAI,EAAC,UAAb;AAAwB,QAAA,EAAE,EAAC,EAA3B;AAA8B,QAAA,QAAQ,EAAEd,YAAxC;AAAsD,QAAA,GAAG,EAAEK,cAA3D;AAAA,gCACE;AAAQ,UAAA,KAAK,EAAC,EAAd;AAAiB,UAAA,QAAQ,MAAzB;AAA0B,UAAA,QAAQ,MAAlC;AAAmC,UAAA,MAAM,MAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAQ,UAAA,KAAK,EAAC,EAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF,EAIIhC,cAAc,IAAIA,cAAc,CAACS,GAAf,CAAoBiC,GAAD,IAAS;AAC5C,8BAAQ;AAAQ,YAAA,KAAK,EAAEA,GAAf;AAAA,sBAAgCA;AAAhC,aAAyBA,GAAzB;AAAA;AAAA;AAAA;AAAA,kBAAR;AACD,SAFiB,CAJtB;AAAA;AAAA;AAAA;AAAA;AAAA,cAdF,eAsBE;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAqB,QAAA,OAAO,EAAET,kBAA9B;AAAkD,QAAA,KAAK,EAAC;AAAxD;AAAA;AAAA;AAAA;AAAA,cAtBF;AAAA;AAAA;AAAA;AAAA;AAAA,YA9BF,eAwDE,QAAC,MAAD;AACE,MAAA,UAAU,EAAE3B,UADd;AAEE,MAAA,WAAW,EAAEJ,WAFf;AAGE,MAAA,KAAK,EAAEa;AAHT;AAAA;AAAA;AAAA;AAAA,YAxDF,eA+DE;AAAK,MAAA,EAAE,EAAEhC,KAAK,CAACe,SAAf;AAAA,gBACGA,SAAS,CAACU,MAAV,GACEa,aAAa,CAACZ,GAAd,CAAmBkC,OAAD,IAAa;AAC9B,4BACE,QAAC,WAAD;AAEE,UAAA,IAAI,EAAEA,OAAO,CAACd,IAFhB;AAGE,UAAA,MAAM,EAAEc,OAAO,CAACvD,MAHlB;AAIE,UAAA,IAAI,EAAEuD,OAAO,CAACC,IAJhB;AAKE,UAAA,SAAS,EAAED,OAAO,CAACE,SALrB;AAME,UAAA,EAAE,EAAEF,OAAO,CAACL;AANd,WACOK,OAAO,CAACL,EADf;AAAA;AAAA;AAAA;AAAA,gBADF;AAUD,OAXA,CADF,gBAaI;AAAK,QAAA,SAAS,EAAEvD,KAAK,CAAC+D;AAAtB;AAAA;AAAA;AAAA;AAAA;AAdP;AAAA;AAAA;AAAA;AAAA,YA/DF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAmFD;;GArLuB9D,I;UACLT,W,EASCC,W,EACKA,W;;;KAXDQ,I","sourcesContent":["import React from \"react\";\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getCountries, getActivitiesList, countriesTools } from \"../actions\";\nimport { Link } from \"react-router-dom\";\nimport CountryCard from \"./CountryCard.jsx\";\nimport Paging from \"./Paging\";\nimport style from \"./Home.module.css\";\nimport \"./Global.css\";\n\nexport default function Home() {\n  const dispatch = useDispatch();\n\n  // LOCAL STATES\n  const [filter, setFilter] = useState({ region: \"\", activity: \"\" });\n  const [order, setOrder] = useState('');\n  const [searchText, setSearchText] = useState('');\n  const [allCountries, setAllCountries] = useState([]);\n  const [regionList, setRegionList] = useState([]);\n  // GLOBAL STATE\n  const countries = useSelector((state) => state.countries, () => { });\n  const activitiesList = useSelector((state) => state.activitiesList);\n  // DOM REFERENCES\n  const inputSearch = useRef();\n  // PAGING\n  const [currentPage, setCurrentPage] = useState(1);\n  const [countriesXPage, setCountriesXPage] = useState(9);\n  const [totalPages, setTotalPages] = useState(0);\n\n  // Seria interesante hacer orderList dinámica\n  // const orderList = ['none', 'asc', 'des', 'popUp', 'popDown'];\n\n  /////// INITIALIZATION\n  useEffect(() => {\n    dispatch(getCountries());\n    dispatch(getActivitiesList());\n  }, [])\n  // Cuando countries esta cargado:\n  useEffect(() => {\n    if (allCountries.length === 0) {  // Comprobación, para que esto suceda una sola vez.\n      setAllCountries([...countries]);\n      setRegionList(countries\n        .map((obj) => obj.region) // convierte el obj en arr\n        .filter((item, index, arr) => arr.indexOf(item) === index)); // filtra repeticiones);\n      pages(1);\n    }\n  }, [countries])\n\n  // Re-inicialización forzada con botón\n  function handleReloadDB(e) {\n    e.preventDefault();\n    setAllCountries([]);\n    dispatch(getCountries());\n    dispatch(getActivitiesList());\n  }\n\n  ///// PAGING\n\n  const lastCountry = currentPage * countriesXPage;\n  const firstCountry = lastCountry - countriesXPage;\n  const pageCountries = countries.slice(firstCountry, lastCountry);\n\n  const pages = (page) => {\n    // if (page === 1) setCountriesXPage(9);\n    // else setCountriesXPage(10);\n    setCurrentPage(page);\n  };\n\n  useEffect(() => {\n    if (countries) {\n      const calcTotalPages = Math.ceil(countries.length / countriesXPage)\n      setTotalPages(calcTotalPages);\n      if (currentPage > calcTotalPages) setCurrentPage(1);\n    }\n  }, [countries, countriesXPage]);\n  //////////////////////////// COUNTRIES TOOLS : FILTER, SEARCH && ORDER\n\n  useEffect(() => {\n    dispatch(countriesTools(filter, searchText, order, allCountries));\n    pages(currentPage);\n  }, [order, filter, searchText]);\n\n  // FILTER\n  function handleFilter(e) {\n    setFilter({ ...filter, [e.target.name]: e.target.value }); // { region:'Asia', activity:'Cagar' }\n  }\n  const regionFilter = useRef();\n  const activityFilter = useRef();\n  function handleClearFilters() {\n    setFilter({});\n    regionFilter.current.value = '';\n    activityFilter.current.value = '';\n  }\n  // SEARCH\n  function handleResetButton(e) {\n    e.preventDefault();\n    setSearchText('');\n    inputSearch.current.value = '';\n  }\n  function handleSearchText(e) {\n    setSearchText(e.target.value);\n  }\n  // ORDER\n  function handleOrder(e) {\n    setOrder(e.target.id);\n  }\n\n  // La barra de botones se podria modularizar\n  return (\n    <div id={style.container}>\n\n      {/* Results / page */}\n      <label>Results/page:</label>\n      <input type=\"range\" min='8' max='36' value={countriesXPage} onChange={(e) => setCountriesXPage(e.target.value)} />\n      <span>{countriesXPage}</span>\n      {/* LINK TO ACTIVITIES FORM */}\n      <Link to=\"/activities\">Crear actividad</Link>\n      {/* Reload DB */}\n      <input type=\"button\" value=\"Reload\" onChange={handleReloadDB} />\n\n      <h1>Home de Countries</h1>\n      {/* <button onClick={(e) => { handleReloadDB(e) }}>reload DB</button> */}\n\n      <div id={style.order}>\n        <label>Sort:</label>\n        {/* SELECT ORDER */}\n        <input type=\"button\" id=\"asc\" name=\"order\" value=\"ASC\" onClick={handleOrder} />\n        <input type=\"button\" id=\"des\" name=\"order\" value=\"DES\" onClick={handleOrder} />\n        <input type=\"button\" id=\"popUp\" name=\"order\" value=\"PopUp\" onClick={handleOrder} />\n        <input type=\"button\" id=\"popDown\" name=\"order\" value=\"PopDown\" onClick={handleOrder} />\n      </div>\n\n      {/* SEARCH TEXT */}\n      <div id={style.search}>\n        <label>Search:</label>\n        <input type=\"text\" id=\"searchText\" name=\"searchText\" onChange={handleSearchText} ref={inputSearch} />\n        <input type=\"button\" onClick={handleResetButton} value=\"Reset\" />\n      </div>\n\n      <div id={style.filter}>\n        <label>Filter:</label>\n        {/* SELECT REGION */}\n        {/* MIRA https://www.geeksforgeeks.org/how-to-set-default-value-in-select-using-reactjs/ */}\n        <select name=\"region\" id=\"\" onChange={handleFilter} ref={regionFilter} defaultValue='Filter by region'>\n          <option value=\"\" selected disabled hidden>Filter by region</option>\n          <option value=\"\">All regions</option>\n          {\n            regionList && regionList.map((reg) => {\n              return (<option value={reg} key={reg} >{reg}</option>);\n            })}\n        </select>\n\n        {/* SELECT ACTIVITY  */}\n        <select name=\"activity\" id=\"\" onChange={handleFilter} ref={activityFilter}>\n          <option value=\"\" selected disabled hidden>Filter by activity</option>\n          <option value=\"\" >All activities</option>\n          {\n            activitiesList && activitiesList.map((act) => {\n              return (<option value={act} key={act} >{act}</option>);\n            })}\n        </select>\n        <input type=\"button\" onClick={handleClearFilters} value=\"Clear filters\" />\n      </div>\n\n      {/* PAGING  */}\n      <Paging\n        totalPages={totalPages}\n        currentPage={currentPage}\n        pages={pages}\n      />\n\n      {/* COUNTRY CARDS  */}\n      <div id={style.countries}>\n        {countries.length ?\n          (pageCountries.map((country) => {\n            return (\n              <CountryCard\n                key={country.id}\n                name={country.name}\n                region={country.region}\n                flag={country.flag}\n                flag_icon={country.flag_icon}\n                id={country.id}\n              />\n            );\n          }))\n          : (<div className={style.loader}></div>)}\n      </div>\n\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}